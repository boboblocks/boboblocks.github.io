<!DOCTYPE html>
<html>

<head>
    <title>boboblocks</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
        }

        #blocklyDiv {
            height: 100vh;
            display: flex;
        }

        #workspaceDiv {
            flex: 1;
        }

        #stageDiv {
            flex: 0 0 30%;
            border-left: 1px solid #ddd;
            position: relative;
            padding-top: 56.25%;

        }

        #stageDisplay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ddd;
        }
    </style>
</head>

<body>
    <div id="blocklyDiv">
        <div id="workspaceDiv"></div>
        <div id="stageDiv">
            <div id="stageDisplay">
                <button id="real">real</button></br><iframe id="evenmorereal"></iframe></div>
        </div>
    </div>
    <script>
        var toolbox = {
            "kind": "categoryToolbox",
            "contents": [
                {
                    "kind": "category",
                    "name": "Game Obj",
                    "contents": [
                        { "kind": "block", "type": "add" },
                        { "kind": "block", "type": "make" },
                        { "kind": "block", "type": "readd" },
                        { "kind": "block", "type": "get" },
                        { "kind": "block", "type": "destroy" },
                        { "kind": "block", "type": "destroyAll" }
                    ]
                },
                {
                    "kind": "category",
                    "name": "Components",
                    "contents": [
                        { "kind": "block", "type": "pos" },
                        { "kind": "block", "type": "scale" },
                        { "kind": "block", "type": "rotate" },
                        { "kind": "block", "type": "color" },
                        { "kind": "block", "type": "opacity" },
                        { "kind": "block", "type": "sprite" },
                        { "kind": "block", "type": "text" },
                        { "kind": "block", "type": "polygon" },
                        { "kind": "block", "type": "rect" },
                        { "kind": "block", "type": "circle" },
                        { "kind": "block", "type": "uvquad" },
                        { "kind": "block", "type": "area" },
                        { "kind": "block", "type": "anchor" },
                        { "kind": "block", "type": "z" },
                        { "kind": "block", "type": "outline" },
                        { "kind": "block", "type": "body" },
                        { "kind": "block", "type": "doubleJump" },
                        { "kind": "block", "type": "move" },
                        { "kind": "block", "type": "offscreen" },
                        { "kind": "block", "type": "follow" },
                        { "kind": "block", "type": "shader" },
                        { "kind": "block", "type": "timer" },
                        { "kind": "block", "type": "fixed" },
                        { "kind": "block", "type": "stay" },
                        { "kind": "block", "type": "health" },
                        { "kind": "block", "type": "lifespan" },
                        { "kind": "block", "type": "state" },
                        { "kind": "block", "type": "fadeIn" },
                        { "kind": "block", "type": "mask" },
                        { "kind": "block", "type": "drawon" },
                        { "kind": "block", "type": "tile" },
                        { "kind": "block", "type": "agent" }
                    ]
                },
                {
                    "kind": "category",
                    "name": "Events",
                    "contents": [
                        { "kind": "block", "type": "on" },
                        { "kind": "block", "type": "onUpdate" },
                        { "kind": "block", "type": "onDraw" },
                        { "kind": "block", "type": "onAdd" },
                        { "kind": "block", "type": "onDestroy" },
                        { "kind": "block", "type": "onLoad" },
                        { "kind": "block", "type": "onLoading" },
                        { "kind": "block", "type": "onError" },
                        { "kind": "block", "type": "onResize" },
                        { "kind": "block", "type": "onCleanup" },
                        { "kind": "block", "type": "onGamepadConnect" },
                        { "kind": "block", "type": "onGamepadDisconnect" },
                        { "kind": "block", "type": "onCollide" },
                        { "kind": "block", "type": "onCollideUpdate" },
                        { "kind": "block", "type": "onCollideEnd" },
                        { "kind": "block", "type": "onClick" },
                        { "kind": "block", "type": "onHover" },
                        { "kind": "block", "type": "onHoverUpdate" },
                        { "kind": "block", "type": "onHoverEnd" },
                        { "kind": "block", "type": "onKeyDown" },
                        { "kind": "block", "type": "onKeyPress" },
                        { "kind": "block", "type": "onKeyPressRepeat" },
                        { "kind": "block", "type": "onKeyRelease" },
                        { "kind": "block", "type": "onCharInput" },
                        { "kind": "block", "type": "onMouseDown" },
                        { "kind": "block", "type": "onMousePress" },
                        { "kind": "block", "type": "onMouseRelease" },
                        { "kind": "block", "type": "onMouseMove" },
                        { "kind": "block", "type": "onTouchStart" },
                        { "kind": "block", "type": "onTouchMove" },
                        { "kind": "block", "type": "onTouchEnd" },
                        { "kind": "block", "type": "onScroll" },
                        { "kind": "block", "type": "onHide" },
                        { "kind": "block", "type": "onShow" },
                        { "kind": "block", "type": "onGamepadButtonDown" },
                        { "kind": "block", "type": "onGamepadButtonPress" },
                        { "kind": "block", "type": "onGamepadButtonRelease" },
                        { "kind": "block", "type": "onGamepadStick" },
                        { "kind": "block", "type": "onSceneLeave" }
                    ]
                },
                {
                    "kind": "category",
                    "name": "Assets",
                    "contents": [
                        { "kind": "block", "type": "loadRoot" },
                        { "kind": "block", "type": "loadSprite" },
                        { "kind": "block", "type": "loadSpriteAtlas" },
                        { "kind": "block", "type": "loadAseprite" },
                        { "kind": "block", "type": "loadPedit" },
                        { "kind": "block", "type": "loadBean" },
                        { "kind": "block", "type": "loadJSON" },
                        { "kind": "block", "type": "loadSound" },
                        { "kind": "block", "type": "loadMusic" },
                        { "kind": "block", "type": "loadFont" },
                        { "kind": "block", "type": "loadBitmapFont" },
                        { "kind": "block", "type": "loadShader" },
                        { "kind": "block", "type": "loadShaderURL" },
                        { "kind": "block", "type": "load" },
                        { "kind": "block", "type": "loadProgress" },
                        { "kind": "block", "type": "getSprite" },
                        { "kind": "block", "type": "getSound" },
                        { "kind": "block", "type": "getFont" },
                        { "kind": "block", "type": "getBitmapFont" },
                        { "kind": "block", "type": "getShader" },
                        { "kind": "block", "type": "getAsset" }
                    ]
                },
                {
                    "kind": "category",
                    "name": "Misc",
                    "contents": [
                        { "kind": "block", "type": "screenshot" },
                        { "kind": "block", "type": "download" },
                        { "kind": "block", "type": "downloadText" },
                        { "kind": "block", "type": "downloadJSON" },
                        { "kind": "block", "type": "downloadBlob" },
                        { "kind": "block", "type": "record" },
                        { "kind": "block", "type": "addKaboom" }
                    ]
                }
            ]
        };
        var workspace = Blockly.inject('workspaceDiv', {
            toolbox: toolbox,
            renderer: 'zelos'
        });
        const button = document.getElementById("real");
        const iframe = document.getElementById("evenmorereal");
        button.addEventListener("click", function() {
            const workspaceex = Blockly.getMainWorkspace();
            const code = Blockly.JavaScript.workspaceToCode(workspaceex);
            button.innerHTML = code;
            iframe.style.width = "100%";
            iframe.style.height = iframe.parentElement.clientWidth / 1.778;
            iframe.src = 'data:text/html;charset=utf-8,<head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><script src="https://unpkg.com/kaboom@3000.0.3/dist/kaboom.js"><' + '/script></head><body><script>' + code + '<' + '/script></body>';
        });
    </script>
</body>

</html>
